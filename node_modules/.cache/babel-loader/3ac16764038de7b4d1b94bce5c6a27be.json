{"ast":null,"code":"import cookies from 'react-cookies';\nconst TOKEN_KEY = 'Token';\nconst APP_PERSIST_STORES_TYPES = ['cacheStorage', 'localStorage', 'sessionStorage'];\nconst {\n  parse\n} = JSON;\nconst {\n  stringify\n} = JSON;\nexport const auth = {\n  // /////////////////////////////////////////////////////////////\n  // TOKEN\n  // /////////////////////////////////////////////////////////////\n\n  /**\r\n   * get token from localstorage\r\n   *\r\n   * @param {'localStorage' | 'sessionStorage'} [fromStorage='localStorage'] specify storage\r\n   * @param {any} [tokenKey=TOKEN_KEY]  optionnal parameter to specify a token key\r\n   * @returns {string} token value\r\n   */\n  getToken() {\n    return getStorage(TOKEN_KEY, APP_PERSIST_STORES_TYPES[0]);\n  },\n\n  setToken(token) {\n    return setStorage(token, TOKEN_KEY, APP_PERSIST_STORES_TYPES[0]);\n  },\n\n  /**\r\n   * set the token value into localstorage (managed by localforage)\r\n   *\r\n   * @param {string} [value=''] token value\r\n   * @param {'localStorage' | 'sessionStorage'} [toStorage='localStorage'] specify storage\r\n   * @param {any} [tokenKey='token'] token key\r\n   * @returns {boolean} success/failure flag\r\n   */\n  clearStorage(callback) {\n    for (let i = 0; i < localStorage.length; i++) {\n      if (localStorage.key(i).indexOf(DASHBOARD_KEY) === -1 && localStorage.key(i).indexOf(AVATAR_KEY) === -1) {\n        localStorage.removeItem(localStorage.key(i));\n        i -= 1;\n      }\n    }\n\n    cookies.remove(TOKEN_KEY, {\n      path: '/'\n    });\n    cookies.remove(LOGIN_TRY_KEY, {\n      path: '/'\n    });\n\n    if (callback) {\n      callback(true);\n    }\n  },\n\n  clearLocalStorage() {\n    for (let i = 0; i < localStorage.length; i++) {\n      if (localStorage.key(i).indexOf(DASHBOARD_KEY) === -1 && localStorage.key(i).indexOf(AVATAR_KEY) === -1) {\n        localStorage.removeItem(localStorage.key(i));\n        i -= 1;\n      }\n    }\n  },\n\n  clearAllAppStorage() {\n    if (localStorage) {\n      localStorage.clear();\n    }\n\n    if (sessionStorage) {\n      sessionStorage.clear();\n    }\n\n    cookies.remove(TOKEN_KEY, {\n      path: \"/\"\n    });\n  }\n\n};\n\nfunction setStorage(values, key) {\n  let toStorage = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : APP_PERSIST_STORES_TYPES[1];\n\n  if (toStorage === APP_PERSIST_STORES_TYPES[0]) {\n    cookies.remove(key, {\n      path: \"/\"\n    });\n    cookies.save(key, values, {\n      path: \"/\"\n    });\n  } else if (toStorage === APP_PERSIST_STORES_TYPES[1]) {\n    localStorage.setItem(key, values);\n  } else {\n    sessionStorage.setItem(key, values);\n  }\n}\n\nfunction getStorage(key) {\n  let toStorage = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : APP_PERSIST_STORES_TYPES[1];\n\n  if (toStorage === APP_PERSIST_STORES_TYPES[0]) {\n    if (cookies.load(key, {\n      path: '/'\n    })) {\n      return cookies.load(key, {\n        path: '/'\n      });\n    }\n\n    return null;\n  }\n\n  if (toStorage === APP_PERSIST_STORES_TYPES[1]) {\n    return localStorage.getItem(key);\n  }\n\n  return sessionStorage.getItem(key);\n}\n\nfunction clearStorage(key) {\n  let toStorage = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : APP_PERSIST_STORES_TYPES[0];\n\n  if (toStorage === APP_PERSIST_STORES_TYPES[0]) {\n    return cookie.remove(key);\n  }\n\n  if (toStorage === APP_PERSIST_STORES_TYPES[1]) {\n    return localStorage.removeItem(key);\n  }\n\n  return sessionStorage.removeItem(key);\n}\n\nexport default auth;","map":{"version":3,"names":["cookies","TOKEN_KEY","APP_PERSIST_STORES_TYPES","parse","JSON","stringify","auth","getToken","getStorage","setToken","token","setStorage","clearStorage","callback","i","localStorage","length","key","indexOf","DASHBOARD_KEY","AVATAR_KEY","removeItem","remove","path","LOGIN_TRY_KEY","clearLocalStorage","clearAllAppStorage","clear","sessionStorage","values","toStorage","save","setItem","load","getItem","cookie"],"sources":["C:/Ekinoks/React/ekinoksApp/src/authentication/auth.js"],"sourcesContent":["import cookies from 'react-cookies'\r\n\r\nconst TOKEN_KEY = 'Token';\r\nconst APP_PERSIST_STORES_TYPES = [\r\n  'cacheStorage',\r\n  'localStorage',\r\n  'sessionStorage',\r\n];\r\n\r\nconst {parse} = JSON;\r\nconst {stringify} = JSON;\r\n\r\n\r\nexport const auth = {\r\n  // /////////////////////////////////////////////////////////////\r\n  // TOKEN\r\n  // /////////////////////////////////////////////////////////////\r\n\r\n  /**\r\n   * get token from localstorage\r\n   *\r\n   * @param {'localStorage' | 'sessionStorage'} [fromStorage='localStorage'] specify storage\r\n   * @param {any} [tokenKey=TOKEN_KEY]  optionnal parameter to specify a token key\r\n   * @returns {string} token value\r\n   */\r\n  getToken() {\r\n    return getStorage(TOKEN_KEY, APP_PERSIST_STORES_TYPES[0])\r\n  },\r\n  setToken(token) {\r\n    return setStorage(token,TOKEN_KEY, APP_PERSIST_STORES_TYPES[0])\r\n  },\r\n  \r\n  /**\r\n   * set the token value into localstorage (managed by localforage)\r\n   *\r\n   * @param {string} [value=''] token value\r\n   * @param {'localStorage' | 'sessionStorage'} [toStorage='localStorage'] specify storage\r\n   * @param {any} [tokenKey='token'] token key\r\n   * @returns {boolean} success/failure flag\r\n   */\r\n  \r\n\r\n  clearStorage(callback) {\r\n    for (let i = 0; i < localStorage.length; i++) {\r\n      if (localStorage.key(i).indexOf(DASHBOARD_KEY) === -1 && localStorage.key(i).indexOf(AVATAR_KEY) === -1) {\r\n        localStorage.removeItem(localStorage.key(i));\r\n        i -= 1;\r\n      }\r\n    }\r\n    cookies.remove(TOKEN_KEY, { path: '/' });\r\n    cookies.remove(LOGIN_TRY_KEY, { path: '/' });\r\n    if (callback) {\r\n      callback(true)\r\n    }\r\n  },\r\n  clearLocalStorage() {\r\n    for (let i = 0; i < localStorage.length; i++) {\r\n      if (localStorage.key(i).indexOf(DASHBOARD_KEY) === -1 && localStorage.key(i).indexOf(AVATAR_KEY) === -1) {\r\n        localStorage.removeItem(localStorage.key(i));\r\n        i -= 1;\r\n      }\r\n    }\r\n  },  \r\n  clearAllAppStorage() {\r\n    if (localStorage) {\r\n      localStorage.clear();\r\n    }\r\n    if (sessionStorage) {\r\n      sessionStorage.clear();\r\n    }\r\n    cookies.remove(TOKEN_KEY, { path: \"/\" })\r\n \r\n  },\r\n};\r\n\r\nfunction setStorage(values, key, toStorage = APP_PERSIST_STORES_TYPES[1]) {\r\n  if (toStorage === APP_PERSIST_STORES_TYPES[0]) {\r\n    cookies.remove(key, { path: \"/\" })\r\n    cookies.save(key, values, { path: \"/\" });\r\n  }\r\n else if (toStorage === APP_PERSIST_STORES_TYPES[1]) {\r\n    localStorage.setItem(key, values)\r\n  }\r\n else {\r\n    sessionStorage.setItem(key, values)\r\n  }\r\n}\r\n\r\nfunction getStorage(key, toStorage = APP_PERSIST_STORES_TYPES[1]) {\r\n  if (toStorage === APP_PERSIST_STORES_TYPES[0]) {\r\n    if (cookies.load(key, { path: '/' })) {\r\n      return cookies.load(key, { path: '/' });\r\n    } \r\n      return null;\r\n    \r\n  } if (toStorage === APP_PERSIST_STORES_TYPES[1]) {\r\n    return localStorage.getItem(key)\r\n  } \r\n    return sessionStorage.getItem(key)\r\n  \r\n}\r\n\r\nfunction clearStorage(key, toStorage = APP_PERSIST_STORES_TYPES[0]) {\r\n  if (toStorage === APP_PERSIST_STORES_TYPES[0]) {\r\n    return cookie.remove(key)\r\n  } if (toStorage === APP_PERSIST_STORES_TYPES[1]) {\r\n    return localStorage.removeItem(key);\r\n  } \r\n    return sessionStorage.removeItem(key)\r\n  \r\n}\r\n\r\nexport default auth;"],"mappings":"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"},"metadata":{},"sourceType":"module"}